SELECT COUNT(DISTINCT Н_ВЕДОМОСТИ.ЧЛВК_ИД) AS Отличники
FROM Н_ВЕДОМОСТИ
JOIN Н_ОЦЕНКИ ON Н_ВЕДОМОСТИ.ОЦЕНКА = Н_ОЦЕНКИ.КОД
JOIN Н_УЧЕНИКИ ON Н_ВЕДОМОСТИ.ЧЛВК_ИД = Н_УЧЕНИКИ.ЧЛВК_ИД
JOIN Н_ПЛАНЫ ON Н_УЧЕНИКИ.ПЛАН_ИД = Н_ПЛАНЫ.ИД
JOIN Н_ОТДЕЛЫ ON Н_ПЛАНЫ.ОТД_ИД = Н_ОТДЕЛЫ.ИД
WHERE Н_ОТДЕЛЫ.ОТД_ИД = (
      SELECT ИД FROM Н_ОТДЕЛЫ WHERE КОРОТКОЕ_ИМЯ = 'СПбГУИТМО') 
AND Н_ОЦЕНКИ.ПРИМЕЧАНИЕ = 'отлично';
